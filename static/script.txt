<script>
  /* 지도 렌더링 */
  // map이라는 변수는 교통 레이어에서 사용
  const map = new naver.maps.Map('map', {
    center: new naver.maps.LatLng(37.3595953, 127.1053971),
    scaleControl: false,
    mapDataControl: false,
    zoomControl: true,
    zoomControlOptions: {
      style: naver.maps.ZoomControlStyle.SMALL,
      position: naver.maps.Position.TOP_RIGHT
    },
  })

  /* 현위치로 이동 */
  const getPosition = () => { // 현위치 정보 획득
    navigator.geolocation.getCurrentPosition(splitPosition)
  }
  const splitPosition = (position) => { // 위도와 경도로 분리
    showPosition(
      position.coords.latitude,
      position.coords.longitude
    )
  }
  getPosition() // 실행
  const showPosition = (let, lng) => { // 현위치로 이동
    map.setCenter(new naver.maps.LatLng(let, lng)) 
    var infoWindow = new naver.maps.InfoWindow();
    marker = new naver.maps.Marker({ // 현위치에 마커 표시
      position: new naver.maps.LatLng(let, lng),
      map: map,
      clickable: true
    })
    naver.maps.Event.addListener(marker, "click", function () { // 팝업 실행
      infoWindow.setContent(getContentElement(let, lng)); 
      infoWindow.open(map, marker);
    })
    naver.maps.Event.addListener(map, 'click', function () { // 팝업 종료
      infoWindow.close(); 
    })
    function getContentElement(let, lng) { // 팝업 내용
      return '<div>' + '현위치' + '<br>' + let + '<br>' + lng + '</div>'
    }
  }
</script>